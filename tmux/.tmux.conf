# Prefix
unbind C-b
set-option -g prefix C-a
bind C-a send-prefix
bind C-a last-window

# General
set -sg escape-time 0
set -g history-limit 10000
set -g mouse on  # Optional, comment out if not needed
set -g mode-keys vi

# Navigation (vim-tmux-navigator)
is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind-key -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind-key -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"

# Splits
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind n split-window -h -c "#{pane_current_path}" nvim

# Copy Mode
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -sel clip -i"  # Use "pbcopy" for macOS

# Status Bar
set -g status-style bg=colour235,fg=colour240
set -g status-left "#[fg=colour255,bg=colour241] #S #[fg=colour241,bg=colour235] "
set -g status-right "#[fg=colour241,bg=colour235]#[fg=colour255,bg=colour241] %H:%M "
set -g window-status-format " #I:#W "
set -g window-status-current-format "#[fg=colour235,bg=colour240]#[fg=colour255] #I:#W #[fg=colour240,bg=colour235]"

# Pane Borders
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour240

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-processes 'nvim'
set -g @continuum-restore 'off'
run '~/.tmux/plugins/tpm/tpm'

# Reload Config
bind r source-file ~/.tmux.conf \; display "Reloaded tmux.conf!"
